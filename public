<!doctype html>
<html lang="pl">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Publiczny edytor Notion</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; max-width: 760px }
  textarea { width: 100%; height: 340px; padding: 12px; box-sizing: border-box; }
  button { padding: 10px 16px; font-weight: 600; cursor: pointer; }
  .muted { color: #666; font-size: 14px; }
  .row { display: flex; gap: 12px; align-items: center; }
  input[type=text] { width: 100%; padding: 8px; box-sizing: border-box; }
  .box { border: 1px solid #ddd; border-radius: 8px; padding: 12px; }
</style>
<h1>Edytuj treść</h1>
<p class="muted">Zmienisz tylko sekcję między <code>BEGIN PUBLIC EDIT</code> i <code>END PUBLIC EDIT</code> na wybranej stronie Notion.</p>

<div class="box">
  <label>Endpoint (URL funkcji):</label>
  <input id="endpoint" type="text" placeholder="https://twoj-proxy.vercel.app/api/public-edit">
  <label>Token linku (PUBLIC_EDIT_TOKEN):</label>
  <input id="token" type="text" placeholder="supersekret">
</div>
<br>

<textarea id="t" placeholder="Wklej treść... Każdy akapit oddziel pustą linią."></textarea>
<br><br>
<div class="row">
  <button id="b">Zapisz</button>
  <span id="m" class="muted"></span>
</div>

<script>
document.getElementById('b').onclick = async () => {
  const content = document.getElementById('t').value;
  const ENDPOINT = document.getElementById('endpoint').value.trim();
  const TOKEN = document.getElementById('token').value.trim();
  const msg = document.getElementById('m');
  if (!ENDPOINT || !TOKEN) {
    msg.textContent = 'Podaj endpoint i token.';
    return;
  }
  msg.textContent = 'Zapisywanie...';
  try {
    const r = await fetch(ENDPOINT, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ token: TOKEN, content })
    });
    const data = await r.json();
    if (data.ok) {
      msg.textContent = 'Zapisano ✔';
    } else {
      msg.textContent = 'Błąd: ' + (data.error || r.status);
    }
  } catch (e) {
    msg.textContent = 'Błąd sieci: ' + e.message;
  }
};
</script>
</html>
